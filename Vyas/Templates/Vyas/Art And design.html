{% extends 'Vyas/basic.html' %}
{%block title%} Shvaas Interior Decors {% endblock %}
{% block css %}
    {% endblock %}
{% block body %}
{% load static %}




            
<div class="grid justify-center grid-cols-1 gap-6 sm:grid-cols-2 lg:grid-cols-3">
            {% for i in des %}
                <a rel="noopener noreferrer" class="max-w-sm mx-auto group hover:no-underline focus:no-underline dark:bg-gray-50">
                  <img role="presentation" class="object-cover w-full rounded h-44 dark:bg-gray-500" src="/media/{{i.Art_image}}" />
                  <div class="p-6 space-y-2">
                    <h3 class="text-2xl font-semibold group-hover:underline group-focus:underline" id="namepr{{i.id}}"> {{i.Art_name}} </h3>
                    <p>{{ i.sub_desc }} </p>
                    <br>
                    <u>Company</u> :  {{i.Art_company}}
                    <br>
                    <u>Type</u> :  {{i.Art_type}}
                    <br>
                    <u>For the place</u> : {{i.for_place}}
                    <br>
                    <br>
                    <u>Description</u>:  {{i.Art_description}}
                    <br>
                    <br>
                    <u>Price</u> : Rs. <span id="pricepr{{i.id}}">{{i.Art_price}}</span>
                
                <span id="divpr{{i.id}}" class="divpr">
                    <button id= "pr{{i.id}}"class="btn btn-primary cartArt">Add To Cart</button>
                  </span>
                  </div>
                </a>

        {%endfor%}
            </div>
 {% endblock %}


 {% block js %}   
 <script>
// Find out the cartArt items from localStorage
if (localStorage.getItem('cartArt') == null) {
   var cartArt = {};
} else {
   cartArt = JSON.parse(localStorage.getItem('cartArt'));
   updateCart(cartArt);
}
// If the add to cartArt button is clicked, add/increment the item
//$('.cartArt').click(function() {
$('.divpr').on('click', 'button.cartArt', function() {
   var idstr = this.id.toString();
   if (cartArt[idstr] != undefined) {
       qty = cartArt[idstr][0] + 1;
       
   } else {
       qty = 1;
       name = document.getElementById('name'+idstr).innerHTML;
       price = document.getElementById('price'+idstr).innerHTML;
       cartArt[idstr] = [qty, name , parseInt(price)];

   }
   updateCart(cartArt);
});
//Add Popover to cartArt
$('#popcart').popover();
updatePopover(cartArt);

function updatePopover(cartArt) {
   console.log('We are inside updatePopover');
   var popStr = "";
   
   popStr = popStr + "</div> <a href='/Vyas/Checkout'><button class='btn btn-primary' id ='checkout'>View Cart</button></a> <button class='btn btn-primary' onclick='clearCart()' id ='clearCart'>Clear Cart</button>     "
   
   document.getElementById('popcart').setAttribute('data-content', popStr);
   $('#popcart').popover('show');
}

function clearCart() {
   cartArt = JSON.parse(localStorage.getItem('cartArt'));
   for (var item in cartArt) {
       document.getElementById('div' + item).innerHTML = '<button id="' + item + '" class="btn btn-primary cartArt">Add To Cart</button>'
   }
   cartArt = {};
    updateCart(cartArt);
    localStorage.clear();
    document.getElementById('clearCart').innerHTML=" <button class='btn btn-dark'  id ='clearCart'>Cleared</button>     " 
}

function updateCart(cartArt) {
   var sum = 0;
   for (var item in cartArt) {
       sum = sum + cartArt[item][0];
       document.getElementById('div'+item).innerHTML = "<button id='minus" + item + "' class='btn btn-primary minus'>-</button> <span id='val" + item + "''>" + cartArt[item][0] + "</span> <button id='plus" + item + "' class='btn btn-primary plus'> + </button>";
   }
   localStorage.setItem('cartArt', JSON.stringify(cartArt));
   
   console.log(cartArt);
   updatePopover(cartArt);
}
// If plus or minus button is clicked, change the cartArt as well as the display value
$('.divpr').on("click", "button.minus", function() {
   a = this.id.slice(7, );
   cartArt['pr' + a][0] = cartArt['pr' + a][0] - 1;
   cartArt['pr' + a][0] = Math.max(0, cartArt['pr' + a][0]);
   document.getElementById('valpr' + a).innerHTML = cartArt['pr' + a][0];
   updateCart(cartArt);
});
$('.divpr').on("click", "button.plus", function() {
   a = this.id.slice(6, );
   cartArt['pr' + a][0] = cartArt['pr' + a][0] + 1;
   document.getElementById('valpr' + a).innerHTML = cartArt['pr' + a][0];
   updateCart(cartArt);
});
   
   
   </script>

{% endblock %}










